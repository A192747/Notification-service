# Сервис нотификации пользователей (или отправки информации конкретным пользоватлеям)

## Бизнес требования
1. Возможность загружать имена пользователей + их контакты ( <strong>почта</strong> ) 
   1. ФТ должна существовать возможность отправки сообщений на <strong>почту</strong> 
   2. ФТ должна существовать возможность получать/подгружать файл с контактами от пользователя
2. До всех пользователей 100% должны быть доставлены сообщения
   1. НФТ должна гарантироваться доставка до каждого пользователя, если сервис упадет
3. Можно отправить определенному пользователю сообщение на <strong>почту</strong> 
   1. ФТ должна существовать возможность отправить текст определенному пользователю по имени*
4. Размер загружаемого фала ограничен 1 Мб

## Архитектура (C4)
![Screenshot](https://github.com/A192747/Notification-service/blob/main/images/Arcitecture.jpg)

## Структура
* discovery-service - Сервис Eureka, где "регистрируются" все запущенные микросервисы
* config-service - Сервис откуда все микросервисы подтягивают настройки
* [authentication-service](https://github.com/A192747/Notification-service/blob/main/authentication-service/authentication-service-documentation.yaml) - Сервис аунтификации пользователя (передает данные о пользователе в user-service для регистрации/записи в бд), создает accessToken и refreshToken для пользователя. Обновляет устаревший accessToken
* [contacts-service](https://github.com/A192747/Notification-service/blob/main/contacts-service/contacts-service-documentation.yaml) - Сервис контактов. Создан для подгрузки файла со списком контактов пользователя (в формате EXEL) в базу данных Cassandra. Также возвращает пользователю список его контактов
* [message-handler-service](https://github.com/A192747/Notification-service/blob/main/message-handler-service/message-handler-service-documentation.yaml) - Сервис обработки сообщений от пользователя. Сервис получает сообщение для рассылки от пользователя (проверяет есть ли на данный момент у пользователя сообщение в рассылке, тогда отклоняет рассылку) и если всё хорошо, то кладет его в Kafka
* message-sender-service - Сервис рассылки сообщений. Берет сообщение из Kafka (при масштабировании каждый инстанс берет из своей партиции) и рассылает одному или всем контактам, указанным в Cassandra + отмечает статус рассылки сообщений (NOT_STARTED -> IN_PROCESS -> DONE)
* gateway-service - Api gateway, через который проходят все запросы. При этом проверяется accessToken на валидность и, чтобы в дальнейшем каждому из микросервисов не нужно было парсить токен заново, добавляет необходимые поля (name и role) к запросу





